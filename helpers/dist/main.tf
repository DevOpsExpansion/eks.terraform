resource "null_resource" "values" {
  triggers = {
    values = var.trigger
  }

  # Pull chart source
  provisioner "local-exec" {
    command    = "helm pull --repo ${var.repo} ${var.chart_name} --version ${var.chart_version} --untar --untardir ${var.path}/"
    on_failure = continue
    when       = create
  }

  # Remove empty folder generated by helm pull command
  provisioner "local-exec" {
    command    = "rm -rf ${var.path}/${var.chart_name}-${var.chart_version}.tgz"
    on_failure = continue
    when       = create
  }
}
